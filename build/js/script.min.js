document.getElementById("animation")&&lottie.loadAnimation({container:document.getElementById("animation"),renderer:"svg",loop:!0,autoplay:!0,path:"data.json"}),function(){var e="https://split.daichicloud.ru/brands/all",t="GET",s=200,n=300,i=function(e,t){var i=new XMLHttpRequest;return i.timeout=1e4,i.responseType="json",i.addEventListener("load",(function(){!function(e){return e.status<s||e.status>n}(i)?e(i.response):t("Данные не загрузились. Причина: "+i.status+" "+i.statusText)})),i.addEventListener("error",(function(){t("Произошла ошибка соединения")})),i.addEventListener("timeout",(function(){t("Запрос не успел выполниться за "+i.timeout+"мс")})),i},o=function(e){e.remove()},c=function(e){var t=document.createElement("div");t.style="z-index: 100; margin: 0 auto; text-align: center; background-color: red;",t.style.position="absolute",t.style.left=0,t.style.right=0,t.style.fontSize="30px",t.textContent=e,document.body.insertAdjacentElement("afterbegin",t),window.setTimeout(o,2e3,t)};window.backend={load:function(s,n){var o=i(s,n||c);o.open(t,e),o.send()}}}(),jQuery,function(e,t){let s="",n="";const i=document.querySelector(".model-choice__brand-list"),o=document.querySelector(".model-choice__brand-choice"),c=document.querySelector(".model-choice__series-list"),a=document.querySelector(".model-choice__series-choice"),d=document.querySelector(".model-choice__select-brand"),l=document.querySelector(".model-choice__select-series");if(!i)return;let r=-1,m=-1;document.querySelector(".model-choice__series-wrapper"),document.querySelector("#series").content.querySelector(".model-choice__series-select");const u=document.querySelector(".model-choice__link"),p=e=>{let s="";return t.forEach(t=>{""===s&&-1!==e.toLowerCase().indexOf(t)&&(s=t)}),""===s?"":s+".html"},h=()=>{if(!i.classList.contains("show"))return i.classList.add("show"),void o.classList.add("opened");i.classList.contains("show")&&(i.classList.remove("show"),o.classList.remove("opened"))},_=()=>{if(!c.classList.contains("show"))return c.classList.add("show"),void a.classList.add("opened");c.classList.contains("show")&&(c.classList.remove("show"),a.classList.remove("opened"))},L=e=>{let t=e.target;t.classList.contains("model-choice__brand-choice")||t.classList.contains("model-choice__brand-item")||t.classList.contains("model-choice__brand-list")||!i.classList.contains("show")||(i.classList.remove("show"),o.classList.remove("opened")),t.classList.contains("model-choice__series-choice")||t.classList.contains("model-choice__series-item")||t.classList.contains("model-choice__series-list")||!c.classList.contains("show")||(c.classList.remove("show"),a.classList.remove("opened"))};e.load(e=>{let t=document.createDocumentFragment(),v=0;e.forEach(e=>{let s=document.createElement("li");s.textContent=e.title,s.classList.add("model-choice__brand-item"),s.setAttribute("data-id",v),v++,t.appendChild(s)}),i.appendChild(t);let b=document.createDocumentFragment();e.forEach(e=>{let t=document.createElement("option");t.textContent=e.title,t.classList.add("model-choice__brand-option"),t.setAttribute("data-id",v),b.appendChild(t)}),d.appendChild(b);o.addEventListener("click",h),a.addEventListener("click",_),i.addEventListener("click",t=>{let s=t.target,d=+s.getAttribute("data-id");if(s.classList.contains("model-choice__brand-item")&&(r===d&&(i.classList.remove("show"),o.classList.remove("opened")),r!==d)){c.innerHTML="",a.textContent="Выбрать из списка",a.classList.remove("selected");let t=document.createDocumentFragment(),d=+s.getAttribute("data-id");e[d].series.forEach(e=>{let s=document.createElement("li");s.textContent=e.title,s.classList.add("model-choice__series-item"),t.appendChild(s)}),c.appendChild(t),r=d,o.textContent=s.textContent,n=s.textContent,o.classList.contains("selected")||o.classList.add("selected"),a.hasAttribute("disabled")&&a.removeAttribute("disabled"),i.classList.remove("show"),o.classList.remove("opened"),u.classList.add("disabled"),u.removeAttribute("href")}}),c.addEventListener("click",e=>{let t=e.target;t.classList.contains("model-choice__series-item")&&(a.textContent=t.textContent,a.classList.contains("selected")||a.classList.add("selected"),c.classList.remove("show"),a.classList.remove("opened"),u.classList.remove("disabled"),s=t.textContent,u.setAttribute("href",p(s)))}),d.addEventListener("change",t=>{m=t.target.selectedIndex-1,l.innerHTML="",a.textContent="Выбрать из списка",a.classList.remove("selected");let s=document.createElement("option");s.textContent="",s.setAttribute("disabled",""),s.setAttribute("selected",""),s.style.display="none",l.appendChild(s);let i=document.createDocumentFragment();l.hasAttribute("disabled")&&l.removeAttribute("disabled"),e[m].series.forEach(e=>{let t=document.createElement("option");t.textContent=e.title,t.classList.add("model-choice__series-option"),i.appendChild(t)}),l.appendChild(i),o.textContent=t.target.value,n=t.target.value,o.classList.contains("selected")||o.classList.add("selected"),u.classList.add("disabled"),u.removeAttribute("href")}),l.addEventListener("change",e=>{a.textContent=e.target.value,a.classList.contains("selected")||a.classList.add("selected"),u.classList.remove("disabled"),s=e.target.value,u.setAttribute("href",p(s))}),u.addEventListener("click",e=>{e.preventDefault();let t=e.target.getAttribute("href");""!==t?document.location.href=t:alert("Инструкция по установке Wi-Fi контроллера для данной серии кондиционера в скором времени появится.")}),document.addEventListener("mousedown",L)})}(window.backend,window.PAGES),function(){const e=document.querySelector(".equipment__wrapper"),t=document.querySelector(".equipment__container");if(!e)return;(()=>{let s=document.createDocumentFragment(),n=e.cloneNode(!0);n.className="equipment__slide-wrapper",n.classList.add("swiper-wrapper");let i=document.createElement("div");i.classList.add("equipment__pagination"),i.classList.add("swiper-pagination"),s.appendChild(n),s.appendChild(i),t.appendChild(s),t.querySelectorAll(".equipment__item").forEach(e=>{e.classList.add("swiper-slide")}),new Swiper(".equipment__container",{pagination:{el:".equipment__pagination",type:"bullets"},loop:!0})})()}(),function(){const e=document.querySelector(".process__wrapper"),t=document.querySelector(".process__container");if(!e)return;(()=>{let s=document.createDocumentFragment(),n=e.cloneNode(!0);n.className="process__slide-wrapper",n.classList.add("swiper-wrapper");let i=document.createElement("div");i.classList.add("process__pagination"),i.classList.add("swiper-pagination");let o=document.createElement("div");o.className="process__number",o.textContent=1,s.appendChild(n),s.appendChild(i),s.appendChild(o),t.appendChild(s),t.querySelectorAll(".process__item").forEach(e=>{e.classList.add("swiper-slide")});(e=>{const s=t.querySelector(".process__number");e.on("slideChange",()=>{s.textContent=e.realIndex+1})})(new Swiper(".process__container",{pagination:{el:".process__pagination",type:"bullets"},loop:!0}))})()}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuaW1hdGlvbi5qcyIsImJhY2tlbmQuanMiLCJzZWxlY3QuanMiLCJjaG9pY2UuanMiLCJlcXVpcG1lbnQuanMiLCJwcm9jZXNzLmpzIl0sIm5hbWVzIjpbImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJsb3R0aWUiLCJsb2FkQW5pbWF0aW9uIiwiY29udGFpbmVyIiwicmVuZGVyZXIiLCJsb29wIiwiYXV0b3BsYXkiLCJwYXRoIiwiUmVxVXJsIiwiUmVxTWV0aG9kIiwiUmVxU3RhdHVzIiwiY3JlYXRlUmVxdWVzdCIsIm9uTG9hZCIsIm9uRXJyb3IiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsInRpbWVvdXQiLCJyZXNwb25zZVR5cGUiLCJhZGRFdmVudExpc3RlbmVyIiwic3RhdHVzIiwiaXNFcnJvclN0YXR1cyIsInJlc3BvbnNlIiwic3RhdHVzVGV4dCIsInJlbW92ZUVsZW1lbnQiLCJlbGVtZW50IiwicmVtb3ZlIiwib25BbnlFcnJvciIsIm1lc3NhZ2UiLCJub2RlIiwiY3JlYXRlRWxlbWVudCIsInN0eWxlIiwicG9zaXRpb24iLCJsZWZ0IiwicmlnaHQiLCJmb250U2l6ZSIsInRleHRDb250ZW50IiwiYm9keSIsImluc2VydEFkamFjZW50RWxlbWVudCIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJiYWNrZW5kIiwibG9hZCIsInJlcSIsIm9wZW4iLCJzZW5kIiwialF1ZXJ5IiwiUEFHRVMiLCJzZXJpZXNOYW1lIiwiYnJhbmROYW1lIiwiYnJhbmRMaXN0IiwicXVlcnlTZWxlY3RvciIsImJyYW5kQnV0dG9uIiwic2VyaWVzTGlzdCIsInNlcmllc0J1dHRvbiIsImJyYW5kU2VsZWN0Iiwic2VyaWVzU2VsZWN0IiwiY3VycmVudEJyYW5kSWR4IiwiY3VycmVudE9wdGlvbklkeCIsImNvbnRlbnQiLCJsaW5rIiwiZ2V0SHJlZiIsInNlcmllcyIsImhyZWYiLCJmb3JFYWNoIiwicGFnZSIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsIm9uQnJhbmRDbGljayIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiYWRkIiwib25TZXJpZXNDbGljayIsIm9uT3V0c2lkZUNsaWNrIiwiZXZ0IiwidGFyZ2V0IiwiYXJyIiwiZnJhZ21lbnQiLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwiaSIsIml0ZW0iLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsImZyYWdtZW50MSIsIm5vZGUxIiwiaWR4IiwiZ2V0QXR0cmlidXRlIiwiaW5uZXJIVE1MIiwic2VyaWUiLCJoYXNBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJzZWxlY3RlZEluZGV4IiwiZGlzcGxheSIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJsb2NhdGlvbiIsImFsZXJ0Iiwid3JhcHBlciIsIndyYXBwZXJOb2RlIiwiY2xvbmVOb2RlIiwiY2xhc3NOYW1lIiwicGFnaW5hdGlvbk5vZGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiU3dpcGVyIiwicGFnaW5hdGlvbiIsImVsIiwidHlwZSIsInJlbmRlclNsaWRlciIsIm51bWJlck5vZGUiLCJzd2lwZXIiLCJudW1iZXJGaWVsZCIsIm9uIiwicmVhbEluZGV4IiwiYWRkTnVtYmVyaW5nIl0sIm1hcHBpbmdzIjoiQUFDQUEsU0FBQUMsZUFBQSxjQUlBQyxPQUFBQyxjQUFBLENBQ0FDLFVBQUFKLFNBQUFDLGVBQUEsYUFDQUksU0FBQSxNQUNBQyxNQUFBLEVBQ0FDLFVBQUEsRUFDQUMsS0FBQSxjQ1JBLFdBQ0EsSUFBQUMsRUFDQSwwQ0FJQUMsRUFDQSxNQUlBQyxFQUNBLElBREFBLEVBRUEsSUFVQUMsRUFBQSxTQUFBQyxFQUFBQyxHQUNBLElBQUFDLEVBQUEsSUFBQUMsZUFzQkEsT0FwQkFELEVBQUFFLFFBVkEsSUFXQUYsRUFBQUcsYUFBQSxPQUVBSCxFQUFBSSxpQkFBQSxRQUFBLFlBWEEsU0FBQUosR0FDQSxPQUFBQSxFQUFBSyxPQUFBVCxHQUNBSSxFQUFBSyxPQUFBVCxFQVVBVSxDQUFBTixHQUtBRixFQUFBRSxFQUFBTyxVQUpBUixFQUFB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QSxFQUFBWCxVQUFBRSxJQUFBLGtCQVpBLElBQUFnQyxPQUFBLHdCQUFBLENBQ0FDLFdBQUEsQ0FDQUMsR0FBQSx5QkFDQUMsS0FBQSxXQUVBcEcsTUFBQSxLQStCQXFHLEdBN0NBLEdDQUEsV0FDQSxNQUFBVixFQUFBakcsU0FBQW1ELGNBQUEscUJBQ0EvQyxFQUFBSixTQUFBbUQsY0FBQSx1QkFFQSxJQUFBOEMsRUFDQSxPQTRCQSxNQUNBLElBQUFwQixFQUFBN0UsU0FBQThFLHlCQUVBb0IsRUFBQUQsRUFBQUUsV0FBQSxHQUNBRCxFQUFBRSxVQUFBLHlCQUNBRixFQUFBN0IsVUFBQUUsSUFBQSxrQkFFQSxJQUFBOEIsRUFBQXJHLFNBQUE4QixjQUFBLE9BQ0F1RSxFQUFBaEMsVUFBQUUsSUFBQSx1QkFDQThCLEVBQUFoQyxVQUFBRSxJQUFBLHFCQUVBLElBQUFxQyxFQUFBNUcsU0FBQThCLGNBQUEsT0FDQThFLEVBQUFSLFVBQUEsa0JBQ0FRLEVBQUF4RSxZQUFBLEVBRUF5QyxFQUFBSyxZQUFBZ0IsR0FDQXJCLEVBQUFLLFlBQUFtQixHQUNBeEIsRUFBQUssWUFBQTBCLEdBRUF4RyxFQUFBOEUsWUFBQUwsR0FDQXpFLEVBbENBa0csaUJBQUEsa0JBQ0F0QyxRQUFBZ0IsSUFDQUEsRUFBQVgsVUFBQUUsSUFBQSxrQkFJQSxDQUFBc0MsSUFDQSxNQUFBQyxFQUFBMUcsRUFBQStDLGNBQUEsb0JBRUEwRCxFQUFBRSxHQUFBLGNBQUEsS0FDQUQsRUFBQTFFLFlBQUF5RSxFQUFBRyxVQUFBLEtBMkJBQyxDQS9DQSxJQUFBVixPQUFBLHNCQUFBLENBQ0FDLFdBQUEsQ0FDQUMsR0FBQSx1QkFDQUMsS0FBQSxXQUVBcEcsTUFBQSxNQTZDQXFHLEdBM0RBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmltYXRpb24nKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGxvdHRpZS5sb2FkQW5pbWF0aW9uKHtcbiAgICBjb250YWluZXI6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmltYXRpb24nKSwgLy8gdGhlIGRvbSBlbGVtZW50IHRoYXQgd2lsbCBjb250YWluIHRoZSBhbmltYXRpb25cbiAgICByZW5kZXJlcjogJ3N2ZycsXG4gICAgbG9vcDogdHJ1ZSxcbiAgICBhdXRvcGxheTogdHJ1ZSxcbiAgICBwYXRoOiAnZGF0YS5qc29uJyAvLyB0aGUgcGF0aCB0byB0aGUgYW5pbWF0aW9uIGpzb25cbiAgfSk7XG59KSgpO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgUmVxVXJsID0ge1xuICAgIEdFVDogJ2h0dHBzOi8vc3BsaXQuZGFpY2hpY2xvdWQucnUvYnJhbmRzL2FsbCcsXG4gICAgLy9QT1NUOiAnaHR0cHM6Ly9qcy5kdW1wLmFjYWRlbXkva2Vrc3RhZ3JhbSdcbiAgfTtcblxuICB2YXIgUmVxTWV0aG9kID0ge1xuICAgIEdFVDogJ0dFVCcsXG4gICAgUE9TVDogJ1BPU1QnXG4gIH07XG5cbiAgdmFyIFJlcVN0YXR1cyA9IHtcbiAgICBPSzogMjAwLFxuICAgIE1VTFRJUExFX0NIT0lDRVM6IDMwMCxcbiAgfTtcblxuICB2YXIgVElNRU9VVCA9IDEwMDAwO1xuXG4gIHZhciBpc0Vycm9yU3RhdHVzID0gZnVuY3Rpb24gKHhocikge1xuICAgIHJldHVybiB4aHIuc3RhdHVzIDwgUmVxU3RhdHVzLk9LXG4gICAgICB8fCB4aHIuc3RhdHVzID4gUmVxU3RhdHVzLk1VTFRJUExFX0NIT0lDRVM7XG4gIH07XG5cbiAgdmFyIGNyZWF0ZVJlcXVlc3QgPSBmdW5jdGlvbiAob25Mb2FkLCBvbkVycm9yKSB7XG4gICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG4gICAgeGhyLnRpbWVvdXQgPSBUSU1FT1VUO1xuICAgIHhoci5yZXNwb25zZVR5cGUgPSAnanNvbic7XG5cbiAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChpc0Vycm9yU3RhdHVzKHhocikpIHtcbiAgICAgICAgb25FcnJvcign0JTQsNC90L3Ri9C1INC90LUg0LfQsNCz0YDRg9C30LjQu9C40YHRjC4g0J/RgNC40YfQuNC90LA6ICcgKyB4aHIuc3RhdHVzICsgJyAnICsgeGhyLnN0YXR1c1RleHQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIG9uTG9hZCh4aHIucmVzcG9uc2UpO1xuICAgIH0pO1xuXG4gICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZnVuY3Rpb24gKCkge1xuICAgICAgb25FcnJvcign0J/RgNC+0LjQt9C+0YjQu9CwINC+0YjQuNCx0LrQsCDRgdC+0LXQtNC40L3QtdC90LjRjycpO1xuICAgIH0pO1xuXG4gICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ3RpbWVvdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBvbkVycm9yKCfQl9Cw0L/RgNC+0YEg0L3QtSDRg9GB0L/QtdC7INCy0YvQv9C+0LvQvdC40YLRjNGB0Y8g0LfQsCAnICsgeGhyLnRpbWVvdXQgKyAn0LzRgScpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHhocjtcbiAgfTtcblxuICB2YXIgcmVtb3ZlRWxlbWVudCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgfTtcblxuICB2YXIgb25BbnlFcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdmFyIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBub2RlLnN0eWxlID0gJ3otaW5kZXg6IDEwMDsgbWFyZ2luOiAwIGF1dG87IHRleHQtYWxpZ246IGNlbnRlcjsgYmFja2dyb3VuZC1jb2xvcjogcmVkOyc7XG4gICAgbm9kZS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgbm9kZS5zdHlsZS5sZWZ0ID0gMDtcbiAgICBub2RlLnN0eWxlLnJpZ2h0ID0gMDtcbiAgICBub2RlLnN0eWxlLmZvbnRTaXplID0gJzMwcHgnO1xuXG4gICAgbm9kZS50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG4gICAgZG9jdW1lbnQuYm9keS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBub2RlKTtcbiAgICB3aW5kb3cuc2V0VGltZW91dChyZW1vdmVFbGVtZW50LCAyMDAwLCBub2RlKTtcbiAgfTtcblxuICB3aW5kb3cuYmFja2VuZCA9IHtcbiAgICBsb2FkOiBmdW5jdGlvbiAob25Mb2FkLCBvbkVycm9yKSB7XG4gICAgICB2YXIgcmVxID0gY3JlYXRlUmVxdWVzdChvbkxvYWQsIG9uRXJyb3IgfHwgb25BbnlFcnJvcik7XG4gICAgICByZXEub3BlbihSZXFNZXRob2QuR0VULCBSZXFVcmwuR0VUKTtcbiAgICAgIHJlcS5zZW5kKCk7XG4gICAgfSxcblxuICAgIC8vIHNhdmU6IGZ1bmN0aW9uIChkYXRhLCBvbkxvYWQsIG9uRXJyb3IpIHtcbiAgICAvLyAgIHZhciByZXEgPSBjcmVhdGVSZXF1ZXN0KG9uTG9hZCwgb25FcnJvcik7XG4gICAgLy8gICByZXEub3BlbihSZXFNZXRob2QuUE9TVCwgUmVxVXJsLlBPU1QpO1xuICAgIC8vICAgcmVxLnNlbmQoZGF0YSk7XG4gICAgLy8gfVxuICB9O1xufSkoKTtcblxuXG5cblxuIiwiLy8gJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4vLyAgIC8vICQoJy5tb2RlbC1jaG9pY2VfX2JyYW5kLXNlbGVjdCcpLnNlbGVjdDIoe1xuLy8gICAvLyAgIG1pbmltdW1SZXN1bHRzRm9yU2VhcmNoOiAtMSxcbi8vICAgLy8gfSk7XG5cbi8vICAgLy8gJCgnLm1vZGVsLWNob2ljZV9fc2VyaWVzLXNlbGVjdCcpLnNlbGVjdDIoe1xuLy8gICAvLyAgIG1pbmltdW1SZXN1bHRzRm9yU2VhcmNoOiAtMSxcbi8vICAgLy8gfSk7XG5cbi8vICAgZnVuY3Rpb24gbWFrZVNlbGVjdChlbGVtZW50KSB7XG4vLyAgICAgJChlbGVtZW50KS5zZWxlY3QyKHtcbi8vICAgICAgIG1pbmltdW1SZXN1bHRzRm9yU2VhcmNoOiAtMSxcbi8vICAgICB9KTtcbi8vICAgfTtcblxuXG5cblxuLy8gICB3aW5kb3cubWFrZVNlbGVjdCA9IG1ha2VTZWxlY3Q7XG5cbi8vICAgY29uc29sZS5sb2cod2luZG93Lm1ha2VTZWxlY3QpO1xuXG4vLyB9KTtcblxuXG4oZnVuY3Rpb24oJCkge1xuICAvLyBmdW5jdGlvbiBtYWtlU2VsZWN0KGVsZW1lbnRDbGFzcykge1xuICAvLyAgICQoZWxlbWVudENsYXNzKS5zZWxlY3QyKHtcbiAgLy8gICAgIG1pbmltdW1SZXN1bHRzRm9yU2VhcmNoOiAtMSxcbiAgLy8gICB9KTtcbiAgLy8gfTtcblxuICAvLyB3aW5kb3cubWFrZVNlbGVjdCA9IG1ha2VTZWxlY3Q7XG59KShqUXVlcnkpO1xuIiwiKGZ1bmN0aW9uIChiYWNrZW5kLCBQQUdFUykge1xuICAvLyBjb25zdCBzcGxpdHMgPSBbXG4gIC8vICAge1xuICAvLyAgICAgXCJpZFwiOjcsXG4gIC8vICAgICBcInRpdGxlXCI6XCJBeGlvbWFcIixcbiAgLy8gICAgIFwic2VyaWVzXCI6W1xuICAvLyAgICAgICB7XG4gIC8vICAgICAgICAgXCJpZFwiOjYzLFxuICAvLyAgICAgICAgIFwidGl0bGVcIjpcIkFTWF9BXCJcbiAgLy8gICAgICAgfSxcbiAgLy8gICAgICAge1xuICAvLyAgICAgICAgIFwiaWRcIjo2MixcbiAgLy8gICAgICAgICBcInRpdGxlXCI6XCJBU1hfQVpcIlxuICAvLyAgICAgICB9XG4gIC8vICAgICBdXG4gIC8vICAgfSxcbiAgLy8gICB7XCJpZFwiOjYsXCJ0aXRsZVwiOlwiRGFpY2hpXCIsXCJzZXJpZXNcIjpbe1wiaWRcIjo0NSxcInRpdGxlXCI6XCJDYXJib24gREFfRFZRXCJ9LHtcImlkXCI6NDYsXCJ0aXRsZVwiOlwiRXZlcmVzdCBEQV9FVlFcIn0se1wiaWRcIjo0MyxcInRpdGxlXCI6XCJQZWFrIERBX0FWUVNcIn0se1wiaWRcIjo0MixcInRpdGxlXCI6XCJYLXRyZW1lIFBlYWsgREFfQVZRU1wifV19LFxuICAvLyAgIHtcImlkXCI6MSxcInRpdGxlXCI6XCJEYWlraW5cIixcInNlcmllc1wiOlt7XCJpZFwiOjExLFwidGl0bGVcIjpcIkNvbWZvcmEgRlRYLUpcXC9HVlwifSx7XCJpZFwiOjI2LFwidGl0bGVcIjpcIkNvbWZvcmEgRlRYUC1LM1wifSx7XCJpZFwiOjI3LFwidGl0bGVcIjpcIkNvbWZvcmEgRlRYUC1MXCJ9LHtcImlkXCI6MjgsXCJ0aXRsZVwiOlwiQ29tZm9yYSBGVFhQLU1cIn0se1wiaWRcIjoyMyxcInRpdGxlXCI6XCJFbXVyYSBGVFhHLUxcIn0se1wiaWRcIjoxOCxcInRpdGxlXCI6XCJFbXVyYSBGVFhKLU1cIn0se1wiaWRcIjoyMCxcInRpdGxlXCI6XCJGTFhTLUJcIn0se1wiaWRcIjoxNixcInRpdGxlXCI6XCJGVFhCLUJcIn0se1wiaWRcIjo2NSxcInRpdGxlXCI6XCJGVFhTLUVcIn0se1wiaWRcIjo2NCxcInRpdGxlXCI6XCJGVFhTLUpcXC9HXCJ9LHtcImlkXCI6MjEsXCJ0aXRsZVwiOlwiRlZYTS1GXCJ9LHtcImlkXCI6MjIsXCJ0aXRsZVwiOlwiRlZYUy1GXCJ9LHtcImlkXCI6MTksXCJ0aXRsZVwiOlwiTmV4dXJhIEZWWEctS1wifSx7XCJpZFwiOjI0LFwidGl0bGVcIjpcIlBlcmZlcmEgRlRYTS1OXCJ9LHtcImlkXCI6MjUsXCJ0aXRsZVwiOlwiUGVyZmVyYSBGVFhTLUtcIn0se1wiaWRcIjoxLFwidGl0bGVcIjpcIlNlbnNpcmEgRlRYQi1DXCJ9XX0sXG4gIC8vICAge1wiaWRcIjoyLFwidGl0bGVcIjpcIktlbnRhdHN1XCIsXCJzZXJpZXNcIjpbe1wiaWRcIjo0OSxcInRpdGxlXCI6XCJCcmF2byAgS1NHQl9IRkFOXCJ9LHtcImlkXCI6NTAsXCJ0aXRsZVwiOlwiQnJhdm8gIEtTR0JBX0haQU5cIn0se1wiaWRcIjo1NixcInRpdGxlXCI6XCJLTUdCQV9IWkFOXCJ9LHtcImlkXCI6NTcsXCJ0aXRsZVwiOlwiS01HQkJfSFpBTlwifSx7XCJpZFwiOjUyLFwidGl0bGVcIjpcIlRlYW0gIEtTR1RfSFpBTlwifSx7XCJpZFwiOjQ3LFwidGl0bGVcIjpcIlRpdGFuIEdlbmVzaXMgS1NHWFwifSx7XCJpZFwiOjUxLFwidGl0bGVcIjpcIlR1cmluIEtTR1VfSFpBTlwifV19LFxuICAvLyAgIHtcImlkXCI6OCxcInRpdGxlXCI6XCJNaWRlYVwiLFwic2VyaWVzXCI6W3tcImlkXCI6NjEsXCJ0aXRsZVwiOlwiQmxhbmMgTVNNQVwifSx7XCJpZFwiOjYwLFwidGl0bGVcIjpcIkJsYW5jIE1TTUEgRVJQIChNQSlcIn0se1wiaWRcIjo1OSxcInRpdGxlXCI6XCJNaXNzaW9uIE1TTUIgKE1CKVwifSx7XCJpZFwiOjU4LFwidGl0bGVcIjpcIlVsdGltYXRlIENvbWZvcnQgTVNNVCAoTVQpXCJ9XX1dO1xuXG5cbiAgbGV0IHNlcmllc05hbWUgPSAnJztcbiAgbGV0IGJyYW5kTmFtZSA9ICcnO1xuICBsZXQgbGlua0hyZWYgPSAnJztcblxuICBjb25zdCBicmFuZENsYXNzID0gJy5tb2RlbC1jaG9pY2VfX2JyYW5kLXNlbGVjdCc7XG4gIGNvbnN0IHNlcmllc0NsYXNzID0gJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1zZWxlY3QnO1xuXG4gIGNvbnN0IGJyYW5kTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX2JyYW5kLWxpc3QnKTtcbiAgY29uc3QgYnJhbmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19icmFuZC1jaG9pY2UnKTtcbiAgY29uc3Qgc2VyaWVzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1saXN0Jyk7XG4gIGNvbnN0IHNlcmllc0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1jaG9pY2UnKTtcbiAgY29uc3QgYnJhbmRTZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19zZWxlY3QtYnJhbmQnKTtcbiAgY29uc3Qgc2VyaWVzU2VsZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGVsLWNob2ljZV9fc2VsZWN0LXNlcmllcycpO1xuXG4gIGlmICghYnJhbmRMaXN0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IGN1cnJlbnRCcmFuZElkeCA9IC0xO1xuICBsZXQgY3VycmVudE9wdGlvbklkeCA9IC0xO1xuXG4gIC8vY29uc3QgYnJhbmRTZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19icmFuZC1zZWxlY3QnKTtcbiAgY29uc3Qgc2VyaWVzV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy13cmFwcGVyJyk7XG4gIGNvbnN0IHNlcmllc1RlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlcmllcycpLmNvbnRlbnQucXVlcnlTZWxlY3RvcignLm1vZGVsLWNob2ljZV9fc2VyaWVzLXNlbGVjdCcpO1xuXG4gIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kZWwtY2hvaWNlX19saW5rJyk7XG5cbiAgY29uc3QgZ2V0SHJlZiA9IChzZXJpZXMpID0+IHtcbiAgICBsZXQgaHJlZiA9ICcnO1xuXG4gICAgUEFHRVMuZm9yRWFjaCgocGFnZSkgPT4ge1xuICAgICAgaWYgKGhyZWYgPT09ICcnKSB7XG4gICAgICAgIGlmIChzZXJpZXMudG9Mb3dlckNhc2UoKS5pbmRleE9mKHBhZ2UpICE9PSAtMSkge1xuICAgICAgICAgIGhyZWYgPSBwYWdlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gaHJlZiA9PT0gJycgPyAnJyA6IGhyZWYgKyAnLmh0bWwnO1xuICB9O1xuXG4gIGNvbnN0IG9uQnJhbmRDbGljayA9ICgpID0+IHtcbiAgICBpZiAoIWJyYW5kTGlzdC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkge1xuICAgICAgYnJhbmRMaXN0LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbiAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ29wZW5lZCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChicmFuZExpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JykpIHtcbiAgICAgIGJyYW5kTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgICBicmFuZEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuZWQnKTtcbiAgICB9XG4gICAgLy8galF1ZXJ5KCcubW9kZWwtY2hvaWNlX19icmFuZC1saXN0JykubUN1c3RvbVNjcm9sbGJhcih7XG4gICAgLy8gICBzZXRIZWlnaHQ6IDE4OSxcbiAgICAvLyAgIGF1dG9IaWRlU2Nyb2xsYmFyOiBmYWxzZSxcbiAgICAvLyAgIHRoZW1lOiAnZGFyaycsXG4gICAgLy8gICBtb3VzZVdoZWVsUGl4ZWxzOiAyMDAsXG4gICAgLy8gICBjb250ZW50VG91Y2hTY3JvbGw6IHRydWVcbiAgICAvLyB9KTtcbiAgfTtcblxuICBjb25zdCBvblNlcmllc0NsaWNrID0gKCkgPT4ge1xuICAgIGlmICghc2VyaWVzTGlzdC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkge1xuICAgICAgc2VyaWVzTGlzdC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XG4gICAgICBzZXJpZXNCdXR0b24uY2xhc3NMaXN0LmFkZCgnb3BlbmVkJyk7XG4gICAgICAvLyBjb25zb2xlLmxvZyhzZXJpZXNMaXN0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbSAtIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHNlcmllc0xpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JykpIHtcbiAgICAgIHNlcmllc0xpc3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBvbk91dHNpZGVDbGljayA9IChldnQpID0+IHtcbiAgICBsZXQgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcblxuICAgIGlmIChcbiAgICAgICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX2JyYW5kLWNob2ljZScpXG4gICAgICAmJiAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kZWwtY2hvaWNlX19icmFuZC1pdGVtJylcbiAgICAgICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX2JyYW5kLWxpc3QnKVxuICAgICAgJiYgYnJhbmRMaXN0LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpXG4gICAgKSB7XG4gICAgICBicmFuZExpc3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgICAgYnJhbmRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGVsLWNob2ljZV9fc2VyaWVzLWNob2ljZScpXG4gICAgICAmJiAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kZWwtY2hvaWNlX19zZXJpZXMtaXRlbScpXG4gICAgICAmJiAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kZWwtY2hvaWNlX19zZXJpZXMtbGlzdCcpXG4gICAgICAmJiBzZXJpZXNMaXN0LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpXG4gICAgKSB7XG4gICAgICBzZXJpZXNMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgIHNlcmllc0J1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuZWQnKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgbWFrZU9wdGlvbk5vZGUgPSAoYXJyKSA9PiB7XG4gICAgbGV0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIGxldCBpID0gMDtcblxuICAgIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBsZXQgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICBub2RlLnRleHRDb250ZW50ID0gaXRlbVsndGl0bGUnXTtcbiAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnbW9kZWwtY2hvaWNlX19icmFuZC1pdGVtJyk7XG4gICAgICBub2RlLnNldEF0dHJpYnV0ZSgnZGF0YS1pZCcsIGkpO1xuICAgICAgaSsrO1xuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XG5cbiAgICAgIC8vIGxldCBzZXJpZXNTZWxlY3QgPSBzZXJpZXNUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAvLyBzZXJpZXNTZWxlY3QuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAvLyBzZXJpZXNTZWxlY3Quc2V0QXR0cmlidXRlKCduYW1lJywgaXRlbVsndGl0bGUnXSk7XG5cbiAgICAgIC8vIGl0ZW0uc2VyaWVzLmZvckVhY2goKHNlcmllKSA9PiB7XG4gICAgICAvLyAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICAvLyAgIG5vZGUuc2V0QXR0cmlidXRlKCd2YWx1ZScsIHNlcmllWyd0aXRsZSddKTtcbiAgICAgIC8vICAgbm9kZS50ZXh0Q29udGVudCA9IHNlcmllWyd0aXRsZSddO1xuICAgICAgLy8gICBzZXJpZXNTZWxlY3QuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgICAvLyB9KTtcblxuICAgICAgLy8gc2VyaWVzV3JhcHBlci5hcHBlbmRDaGlsZChzZXJpZXNTZWxlY3QpO1xuICAgIH0pO1xuXG4gICAgYnJhbmRMaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50KTtcblxuXG4gICAgbGV0IGZyYWdtZW50MSA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICBsZXQgaiA9IDA7XG5cbiAgICBhcnIuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgbGV0IG5vZGUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICBub2RlMS50ZXh0Q29udGVudCA9IGl0ZW1bJ3RpdGxlJ107XG4gICAgICBub2RlMS5jbGFzc0xpc3QuYWRkKCdtb2RlbC1jaG9pY2VfX2JyYW5kLW9wdGlvbicpO1xuICAgICAgbm9kZTEuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgaSk7XG4gICAgICBqKys7XG4gICAgICBmcmFnbWVudDEuYXBwZW5kQ2hpbGQobm9kZTEpO1xuXG4gICAgICAvLyBsZXQgc2VyaWVzU2VsZWN0ID0gc2VyaWVzVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgLy8gc2VyaWVzU2VsZWN0LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgICAgLy8gc2VyaWVzU2VsZWN0LnNldEF0dHJpYnV0ZSgnbmFtZScsIGl0ZW1bJ3RpdGxlJ10pO1xuXG4gICAgICAvLyBpdGVtLnNlcmllcy5mb3JFYWNoKChzZXJpZSkgPT4ge1xuICAgICAgLy8gICBsZXQgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgLy8gICBub2RlLnNldEF0dHJpYnV0ZSgndmFsdWUnLCBzZXJpZVsndGl0bGUnXSk7XG4gICAgICAvLyAgIG5vZGUudGV4dENvbnRlbnQgPSBzZXJpZVsndGl0bGUnXTtcbiAgICAgIC8vICAgc2VyaWVzU2VsZWN0LmFwcGVuZENoaWxkKG5vZGUpO1xuICAgICAgLy8gfSk7XG5cbiAgICAgIC8vIHNlcmllc1dyYXBwZXIuYXBwZW5kQ2hpbGQoc2VyaWVzU2VsZWN0KTtcbiAgICB9KTtcblxuICAgIGJyYW5kU2VsZWN0LmFwcGVuZENoaWxkKGZyYWdtZW50MSk7XG5cblxuXG4gICAgY29uc3Qgb25CcmFuZEl0ZW1DbGljayA9IChldnQpID0+IHtcbiAgICAgIGxldCB0YXJnZXQgPSBldnQudGFyZ2V0O1xuICAgICAgbGV0IGlkeCA9ICt0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XG5cbiAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RlbC1jaG9pY2VfX2JyYW5kLWl0ZW0nKSkge1xuICAgICAgICBpZiAoY3VycmVudEJyYW5kSWR4ID09PSBpZHgpIHtcbiAgICAgICAgICBicmFuZExpc3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgICAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGN1cnJlbnRCcmFuZElkeCAhPT0gaWR4KSB7XG4gICAgICAgICAgc2VyaWVzTGlzdC5pbm5lckhUTUwgPSAnJztcblxuICAgICAgICAgIHNlcmllc0J1dHRvbi50ZXh0Q29udGVudCA9ICfQktGL0LHRgNCw0YLRjCDQuNC3INGB0L/QuNGB0LrQsCc7XG4gICAgICAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7XG5cbiAgICAgICAgICBsZXQgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgICAgbGV0IGlkeCA9ICt0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XG5cbiAgICAgICAgICBhcnJbaWR4XS5zZXJpZXMuZm9yRWFjaCgoc2VyaWUpID0+IHtcbiAgICAgICAgICAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgICAgIG5vZGUudGV4dENvbnRlbnQgPSBzZXJpZVsndGl0bGUnXTtcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnbW9kZWwtY2hvaWNlX19zZXJpZXMtaXRlbScpO1xuICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBzZXJpZXNMaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgICAgICAgICBjdXJyZW50QnJhbmRJZHggPSBpZHg7XG5cbiAgICAgICAgICBicmFuZEJ1dHRvbi50ZXh0Q29udGVudCA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAgICAgICBicmFuZE5hbWUgPSB0YXJnZXQudGV4dENvbnRlbnQ7XG4gICAgICAgICAgaWYgKCFicmFuZEJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgICAgICAgIGJyYW5kQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHNlcmllc0J1dHRvbi5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgICAgICAgIHNlcmllc0J1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJhbmRMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgICAgICBicmFuZEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuZWQnKTtcblxuICAgICAgICAgIGxpbmsuY2xhc3NMaXN0LmFkZCgnZGlzYWJsZWQnKTtcbiAgICAgICAgICBsaW5rLnJlbW92ZUF0dHJpYnV0ZSgnaHJlZicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3Qgb25CcmFuZENoYW5nZSA9IChldnQpID0+IHtcbiAgICAgIGN1cnJlbnRPcHRpb25JZHggPSBldnQudGFyZ2V0LnNlbGVjdGVkSW5kZXggLSAxO1xuICAgICAgc2VyaWVzU2VsZWN0LmlubmVySFRNTCA9ICcnO1xuXG4gICAgICBzZXJpZXNCdXR0b24udGV4dENvbnRlbnQgPSAn0JLRi9Cx0YDQsNGC0Ywg0LjQtyDRgdC/0LjRgdC60LAnO1xuICAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7XG5cbiAgICAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICBub2RlLnRleHRDb250ZW50ID0gJyc7XG4gICAgICBub2RlLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgICBub2RlLnNldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCAnJyk7XG4gICAgICBub2RlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAgIHNlcmllc1NlbGVjdC5hcHBlbmRDaGlsZChub2RlKTtcblxuICAgICAgbGV0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXG4gICAgICBpZiAoc2VyaWVzU2VsZWN0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgICBzZXJpZXNTZWxlY3QucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgICAgfVxuXG5cbiAgICAgIGFycltjdXJyZW50T3B0aW9uSWR4XS5zZXJpZXMuZm9yRWFjaCgoc2VyaWUpID0+IHtcbiAgICAgICAgbGV0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgICAgbm9kZS50ZXh0Q29udGVudCA9IHNlcmllWyd0aXRsZSddO1xuICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ21vZGVsLWNob2ljZV9fc2VyaWVzLW9wdGlvbicpO1xuICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAgIH0pO1xuXG4gICAgICBzZXJpZXNTZWxlY3QuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuXG4gICAgICBicmFuZEJ1dHRvbi50ZXh0Q29udGVudCA9IGV2dC50YXJnZXQudmFsdWU7XG4gICAgICBicmFuZE5hbWUgPSBldnQudGFyZ2V0LnZhbHVlO1xuICAgICAgaWYgKCFicmFuZEJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgICAgYnJhbmRCdXR0b24uY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbiAgICAgIH1cblxuICAgICAgbGluay5jbGFzc0xpc3QuYWRkKCdkaXNhYmxlZCcpO1xuICAgICAgbGluay5yZW1vdmVBdHRyaWJ1dGUoJ2hyZWYnKTtcbiAgICB9XG5cbiAgICBjb25zdCBvblNlcmllc0l0ZW1DbGljayA9IChldnQpID0+IHtcbiAgICAgIGxldCB0YXJnZXQgPSBldnQudGFyZ2V0O1xuXG4gICAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kZWwtY2hvaWNlX19zZXJpZXMtaXRlbScpKSB7XG4gICAgICAgIHNlcmllc0J1dHRvbi50ZXh0Q29udGVudCA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAgICAgaWYgKCFzZXJpZXNCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBzZXJpZXNMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xuXG4gICAgICAgIGxpbmsuY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKTtcbiAgICAgICAgc2VyaWVzTmFtZSA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBnZXRIcmVmKHNlcmllc05hbWUpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBvblNlcmllc0NoYW5nZSA9IChldnQpID0+IHtcbiAgICAgIHNlcmllc0J1dHRvbi50ZXh0Q29udGVudCA9IGV2dC50YXJnZXQudmFsdWU7XG4gICAgICBpZiAoIXNlcmllc0J1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgICAgc2VyaWVzQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgICB9XG5cbiAgICAgIGxpbmsuY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKTtcbiAgICAgIHNlcmllc05hbWUgPSBldnQudGFyZ2V0LnZhbHVlO1xuICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBnZXRIcmVmKHNlcmllc05hbWUpKTtcbiAgICB9XG5cbiAgICBjb25zdCBvbkxpbmtDbGljayA9IChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgbGV0IGhyZWYgPSBldnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuXG4gICAgICBpZiAoaHJlZiA9PT0gJycpIHtcbiAgICAgICAgYWxlcnQoJ9CY0L3RgdGC0YDRg9C60YbQuNGPINC/0L4g0YPRgdGC0LDQvdC+0LLQutC1IFdpLUZpINC60L7QvdGC0YDQvtC70LvQtdGA0LAg0LTQu9GPINC00LDQvdC90L7QuSDRgdC10YDQuNC4INC60L7QvdC00LjRhtC40L7QvdC10YDQsCDQsiDRgdC60L7RgNC+0Lwg0LLRgNC10LzQtdC90Lgg0L/QvtGP0LLQuNGC0YHRjy4nKTtcblxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgPSBocmVmO1xuICAgIH07XG5cbiAgICAvL2xldCBzcGxpdHNEYXRhID0gYmFja2VuZC5sb2FkKGdldERhdGEpO1xuXG4gICAgLy9icmFuZFNlbGVjdC5hcHBlbmRDaGlsZChtYWtlT3B0aW9uTm9kZShzcGxpdHMpKTtcbiAgICAvL21ha2VPcHRpb25Ob2RlKHNwbGl0cyk7XG4gICAgLy9iYWNrZW5kLmxvYWQobWFrZU9wdGlvbk5vZGUpO1xuXG5cbiAgICAvLyBtYWtlU2VsZWN0KGJyYW5kQ2xhc3MpO1xuICAgIC8vIG1ha2VTZWxlY3Qoc2VyaWVzQ2xhc3MpO1xuXG4gICAgLy8galF1ZXJ5KGJyYW5kQ2xhc3MpLnNlbGVjdDIoJ29wZW4nKTtcbiAgICAvLyBqUXVlcnkoYnJhbmRDbGFzcykuc2VsZWN0MignY2xvc2UnKTtcblxuXG4gICAgLy8gY29uc3Qgc2VyaWVzU2VsZWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1zZWxlY3QnKTtcblxuXG4gICAgLy8gY29uc3QgaGlkZVNlcmllcyA9ICgpID0+IHtcbiAgICAvLyAgIHNlcmllc1NlbGVjdHMuZm9yRWFjaCgoc2VsZWN0KSA9PiB7XG4gICAgLy8gICAgIGlmICghc2VsZWN0LmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykpIHtcbiAgICAvLyAgICAgICBzZWxlY3QuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgLy8gICAgICAgc2VsZWN0LnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfSlcbiAgICAvLyB9O1xuXG4gICAgLy8gY29uc3Qgc2hvd1NlcmllcyA9IChpZHgpID0+IHtcbiAgICAvLyAgIHNlcmllc1NlbGVjdHNbaWR4XS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAvLyAgIHNlcmllc1NlbGVjdHNbaWR4XS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3Nlcmllcy1zZWxlY3QnKTtcbiAgICAvLyB9O1xuXG4gICAgLy8galF1ZXJ5KGJyYW5kQ2xhc3MpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgLy8gICBsZXQgaWR4ID0gK2pRdWVyeSgnLm1vZGVsLWNob2ljZV9fYnJhbmQtc2VsZWN0IG9wdGlvbjpzZWxlY3RlZCcpLmF0dHIoJ2RhdGEtaWQnKTtcblxuICAgIC8vICAgaGlkZVNlcmllcygpO1xuICAgIC8vICAgc2hvd1NlcmllcyhpZHggKyAxKTtcblxuICAgIC8vICAgalF1ZXJ5KCcjc2VyaWVzLXNlbGVjdCcpLnNlbGVjdDIoJ29wZW4nKTtcbiAgICAvLyAgIGpRdWVyeSgnI3Nlcmllcy1zZWxlY3QnKS5zZWxlY3QyKCdjbG9zZScpO1xuXG4gICAgLy8gICBqUXVlcnkoJy5tb2RlbC1jaG9pY2VfX2JyYW5kLXNlbGVjdCcpLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xuICAgIC8vICAgalF1ZXJ5KCcubW9kZWwtY2hvaWNlX19zZXJpZXMtc2VsZWN0JykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgLy8gfSk7XG5cbiAgICAvLyBqUXVlcnkoc2VyaWVzQ2xhc3MpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgLy8gICBpZiAobGluay5jbGFzc0xpc3QuY29udGFpbnMoJ2Rpc2FibGVkJykpIHtcbiAgICAvLyAgICAgbGluay5jbGFzc0xpc3QucmVtb3ZlKCdkaXNhYmxlZCcpO1xuICAgIC8vICAgfVxuXG4gICAgLy8gICBsZXQgdmFsdWUgPSBqUXVlcnkoZXZ0LnRhcmdldCkuY2hpbGRyZW4oJ29wdGlvbjpzZWxlY3RlZCcpLnRleHQoKTtcbiAgICAvLyAgIHNlcmllc05hbWUgPSB2YWx1ZTtcblxuXG4gICAgLy8gICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIHNlcmllc05hbWUpO1xuXG4gICAgLy8gICBqUXVlcnkoJy5tb2RlbC1jaG9pY2VfX3Nlcmllcy1zZWxlY3QnKS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICAvLyB9KTtcblxuICAgIC8vUmVzaXplLmluaXQoKTtcbiAgICAvL1Jlc2l6ZS5hZGRMaXN0ZW5lcigpO1xuXG4gICAgYnJhbmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkJyYW5kQ2xpY2spO1xuICAgIHNlcmllc0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uU2VyaWVzQ2xpY2spO1xuICAgIGJyYW5kTGlzdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQnJhbmRJdGVtQ2xpY2spO1xuICAgIHNlcmllc0xpc3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvblNlcmllc0l0ZW1DbGljayk7XG4gICAgYnJhbmRTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25CcmFuZENoYW5nZSk7XG4gICAgc2VyaWVzU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uU2VyaWVzQ2hhbmdlKTtcbiAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25MaW5rQ2xpY2spO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIG9uT3V0c2lkZUNsaWNrKTtcbiAgfTtcblxuICBiYWNrZW5kLmxvYWQobWFrZU9wdGlvbk5vZGUpO1xuXG59KSh3aW5kb3cuYmFja2VuZCwgd2luZG93LlBBR0VTKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXF1aXBtZW50X193cmFwcGVyJyk7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lcXVpcG1lbnRfX2NvbnRhaW5lcicpO1xuXG4gIGlmKCF3cmFwcGVyKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgaW5pdFN3aXBlciA9ICgpID0+IHtcbiAgICByZXR1cm4gbmV3IFN3aXBlcignLmVxdWlwbWVudF9fY29udGFpbmVyJywge1xuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICBlbDogJy5lcXVpcG1lbnRfX3BhZ2luYXRpb24nLFxuICAgICAgICB0eXBlOiAnYnVsbGV0cycsXG4gICAgICB9LFxuICAgICAgbG9vcDogdHJ1ZSxcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBhZGRTbGlkZUNsYXNzID0gKGVsZW1lbnQpID0+IHtcbiAgICBsZXQgaXRlbXMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lcXVpcG1lbnRfX2l0ZW0nKTtcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ3N3aXBlci1zbGlkZScpO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IHJlbmRlclNsaWRlciA9ICgpID0+IHtcbiAgICBsZXQgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cbiAgICBsZXQgd3JhcHBlck5vZGUgPSB3cmFwcGVyLmNsb25lTm9kZSh0cnVlKTtcbiAgICB3cmFwcGVyTm9kZS5jbGFzc05hbWUgPSAnZXF1aXBtZW50X19zbGlkZS13cmFwcGVyJztcbiAgICB3cmFwcGVyTm9kZS5jbGFzc0xpc3QuYWRkKCdzd2lwZXItd3JhcHBlcicpO1xuXG4gICAgbGV0IHBhZ2luYXRpb25Ob2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcGFnaW5hdGlvbk5vZGUuY2xhc3NMaXN0LmFkZCgnZXF1aXBtZW50X19wYWdpbmF0aW9uJyk7XG4gICAgcGFnaW5hdGlvbk5vZGUuY2xhc3NMaXN0LmFkZCgnc3dpcGVyLXBhZ2luYXRpb24nKTtcblxuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHdyYXBwZXJOb2RlKTtcbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChwYWdpbmF0aW9uTm9kZSk7XG5cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICAgIGFkZFNsaWRlQ2xhc3MoY29udGFpbmVyKTtcblxuICAgIGluaXRTd2lwZXIoKTtcbiAgfTtcblxuICByZW5kZXJTbGlkZXIoKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2Nlc3NfX3dyYXBwZXInKTtcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2Nlc3NfX2NvbnRhaW5lcicpO1xuXG4gIGlmICghd3JhcHBlcikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGluaXRTd2lwZXIgPSAoKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBTd2lwZXIoJy5wcm9jZXNzX19jb250YWluZXInLCB7XG4gICAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgIGVsOiAnLnByb2Nlc3NfX3BhZ2luYXRpb24nLFxuICAgICAgICB0eXBlOiAnYnVsbGV0cycsXG4gICAgICB9LFxuICAgICAgbG9vcDogdHJ1ZSxcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBhZGRTbGlkZUNsYXNzID0gKGVsZW1lbnQpID0+IHtcbiAgICBsZXQgaXRlbXMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9jZXNzX19pdGVtJyk7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdzd2lwZXItc2xpZGUnKTtcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBhZGROdW1iZXJpbmcgPSAoc3dpcGVyKSA9PiB7XG4gICAgY29uc3QgbnVtYmVyRmllbGQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2Nlc3NfX251bWJlcicpO1xuXG4gICAgc3dpcGVyLm9uKCdzbGlkZUNoYW5nZScsICgpID0+IHtcbiAgICAgIG51bWJlckZpZWxkLnRleHRDb250ZW50ID0gc3dpcGVyLnJlYWxJbmRleCArIDE7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgcmVuZGVyU2xpZGVyID0gKCkgPT4ge1xuICAgIGxldCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblxuICAgIGxldCB3cmFwcGVyTm9kZSA9IHdyYXBwZXIuY2xvbmVOb2RlKHRydWUpO1xuICAgIHdyYXBwZXJOb2RlLmNsYXNzTmFtZSA9ICdwcm9jZXNzX19zbGlkZS13cmFwcGVyJztcbiAgICB3cmFwcGVyTm9kZS5jbGFzc0xpc3QuYWRkKCdzd2lwZXItd3JhcHBlcicpO1xuXG4gICAgbGV0IHBhZ2luYXRpb25Ob2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcGFnaW5hdGlvbk5vZGUuY2xhc3NMaXN0LmFkZCgncHJvY2Vzc19fcGFnaW5hdGlvbicpO1xuICAgIHBhZ2luYXRpb25Ob2RlLmNsYXNzTGlzdC5hZGQoJ3N3aXBlci1wYWdpbmF0aW9uJyk7XG5cbiAgICBsZXQgbnVtYmVyTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIG51bWJlck5vZGUuY2xhc3NOYW1lID0gJ3Byb2Nlc3NfX251bWJlcic7XG4gICAgbnVtYmVyTm9kZS50ZXh0Q29udGVudCA9IDE7XG5cbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh3cmFwcGVyTm9kZSk7XG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQocGFnaW5hdGlvbk5vZGUpO1xuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKG51bWJlck5vZGUpO1xuXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgICBhZGRTbGlkZUNsYXNzKGNvbnRhaW5lcik7XG5cbiAgICBjb25zdCBwcm9jZXNzU3dpcGVyID0gaW5pdFN3aXBlcigpO1xuICAgIGFkZE51bWJlcmluZyhwcm9jZXNzU3dpcGVyKTtcbiAgfTtcblxuICByZW5kZXJTbGlkZXIoKTtcbn0pKCk7XG4iXX0=
